import{k as U,j as e,l as x}from"./index-rUyRm4_Q.js";import{r,u as V,g as Y,L as $}from"./react-vendor-CaQki1kR.js";import{L as k,I as P}from"./label-BirxAfEm.js";import{C as h,d as g}from"./card-mOhmJQ_G.js";import{o as B,A as j,n as M,E,l as S}from"./ui-vendor-DU0NExUN.js";const C="https://ondorealestateserver.onrender.com/api";function K(){const[i,R]=r.useState(""),[y,O]=r.useState(""),[u,L]=r.useState(!1),[f,I]=r.useState(!1),[b,N]=r.useState(!1),[T,F]=r.useState(!1),[p,l]=r.useState(null),[A,m]=r.useState(""),{toast:n}=U(),v=V(),[J]=Y(),d=J.get("token");r.useEffect(()=>{if(!d){l(!1),m("No reset token provided");return}(async()=>{try{const s=await fetch(`${C}/password/verify-reset-token/${d}`),c=s.headers.get("content-type"),w=c&&c.includes("application/json");let a;if(w)try{const t=await s.text();a=t?JSON.parse(t):{}}catch{l(!1),m("Invalid response from server");return}else a={valid:!1,message:await s.text()||"Invalid or expired reset token"};s.ok&&a.valid?l(!0):(l(!1),m(a.message||"Invalid or expired reset token"))}catch{l(!1),m("Failed to verify reset token")}})()},[d]);const q=async o=>{if(o.preventDefault(),!i){n({title:"Password required",description:"Please enter a new password.",variant:"destructive"});return}if(i.length<8){n({title:"Password too short",description:"Password must be at least 8 characters long.",variant:"destructive"});return}if(i!==y){n({title:"Passwords don't match",description:"Please make sure both passwords are identical.",variant:"destructive"});return}if(!d||p!==!0){n({title:"Invalid token",description:"The reset token is invalid or expired.",variant:"destructive"});return}N(!0);try{const s=await fetch(`${C}/password/reset-password`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:d,password:i})}),c=s.headers.get("content-type"),w=c&&c.includes("application/json");let a;if(w)try{const t=await s.text();a=t?JSON.parse(t):{}}catch{throw new Error("Invalid response from server")}else a={message:await s.text()||"Failed to reset password."};s.ok?(F(!0),n({title:"Password updated",description:"Your password has been successfully reset."})):n({title:"Error",description:a.message||"Failed to reset password.",variant:"destructive"})}catch(s){n({title:"Error",description:s instanceof Error?s.message:"An unexpected error occurred. Please try again.",variant:"destructive"})}finally{N(!1)}};return p===!1?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-white dark:bg-gray-900 p-4",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsx("div",{className:"flex flex-col items-center mb-8",children:e.jsxs("div",{className:"flex items-center mb-6",children:[e.jsx("img",{src:x(),alt:"Ondo Real Estate logo",className:"h-16 w-auto mr-3"}),e.jsx("span",{className:"text-6xl font-medium bg-gradient-to-r from-orange-500 to-red-800 text-transparent bg-clip-text",children:"Ondo Real Estate"})]})}),e.jsx(h,{className:"border-none shadow-lg",children:e.jsxs(g,{className:"pt-6 text-center",children:[e.jsx("div",{className:"flex justify-center mb-6",children:e.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center",children:e.jsx(B,{className:"h-8 w-8 text-red-600"})})}),e.jsx("h1",{className:"text-2xl font-medium mb-4 bg-gradient-to-r from-orange-500 to-red-800 text-transparent bg-clip-text",children:"Invalid Reset Link"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:A||"The password reset link is invalid or has expired."}),e.jsxs("button",{onClick:()=>v("/forgot-password"),className:"w-full bg-gradient-to-r from-orange-500 to-red-800 hover:from-orange-600 hover:to-red-900 text-white font-medium py-4 rounded-2xl text-xl transition-all duration-200 flex items-center justify-center gap-2",children:["Request New Reset Link",e.jsx(j,{className:"h-5 w-5"})]})]})})]})}):p===null?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-white dark:bg-gray-900 p-4",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsx("div",{className:"flex flex-col items-center mb-8",children:e.jsxs("div",{className:"flex items-center mb-6",children:[e.jsx("img",{src:x(),alt:"Ondo Real Estate logo",className:"h-16 w-auto mr-3"}),e.jsx("span",{className:"text-6xl font-medium bg-gradient-to-r from-orange-500 to-red-800 text-transparent bg-clip-text",children:"Ondo Real Estate"})]})}),e.jsx(h,{className:"border-none shadow-lg",children:e.jsxs(g,{className:"pt-6 text-center",children:[e.jsx("div",{className:"flex justify-center mb-6",children:e.jsx("div",{className:"w-8 h-8 border-2 border-orange-500 border-t-transparent rounded-full animate-spin"})}),e.jsx("h1",{className:"text-2xl font-medium mb-4 bg-gradient-to-r from-orange-500 to-red-800 text-transparent bg-clip-text",children:"Verifying Reset Link"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Please wait while we verify your reset link..."})]})})]})}):T?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-white dark:bg-gray-900 p-4",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsx("div",{className:"flex flex-col items-center mb-8",children:e.jsxs("div",{className:"flex items-center mb-6",children:[e.jsx("img",{src:x(),alt:"Ondo Real Estate logo",className:"h-16 w-auto mr-3"}),e.jsx("span",{className:"text-6xl font-medium bg-gradient-to-r from-orange-500 to-red-800 text-transparent bg-clip-text",children:"Ondo Real Estate"})]})}),e.jsx(h,{className:"border-none shadow-lg",children:e.jsxs(g,{className:"pt-6 text-center",children:[e.jsx("div",{className:"flex justify-center mb-6",children:e.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center",children:e.jsx(M,{className:"h-8 w-8 text-green-600"})})}),e.jsx("h1",{className:"text-2xl font-medium mb-4 bg-gradient-to-r from-orange-500 to-red-800 text-transparent bg-clip-text",children:"Password Reset Successful"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"Your password has been successfully updated. You can now sign in with your new password."}),e.jsxs("button",{onClick:()=>v("/login"),className:"w-full bg-gradient-to-r from-orange-500 to-red-800 hover:from-orange-600 hover:to-red-900 text-white font-medium py-4 rounded-2xl text-xl transition-all duration-200 flex items-center justify-center gap-2",children:["Continue to Login",e.jsx(j,{className:"h-5 w-5"})]})]})})]})}):e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-white dark:bg-gray-900 p-4",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsxs("div",{className:"flex flex-col items-center mb-8",children:[e.jsxs("div",{className:"flex items-center mb-6",children:[e.jsx("img",{src:x(),alt:"Ondo Real Estate logo",className:"h-16 w-auto mr-3"}),e.jsx("span",{className:"text-6xl font-medium bg-gradient-to-r from-orange-500 to-red-800 text-transparent bg-clip-text",children:"Ondo Real Estate"})]}),e.jsx("h1",{className:"text-2xl font-medium bg-gradient-to-r from-orange-500 to-red-800 text-transparent bg-clip-text",children:"Reset Password"})]}),e.jsx(h,{className:"border-none shadow-lg",children:e.jsxs(g,{className:"pt-6",children:[e.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-center mb-6",children:"Enter your new password below. Make sure it's strong and secure."}),e.jsxs("form",{onSubmit:q,className:"space-y-5",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"password",className:"text-gray-700 dark:text-gray-300",children:"New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(P,{id:"password",type:u?"text":"password",placeholder:"Enter new password",value:i,onChange:o=>R(o.target.value),className:"rounded-xl border-gray-300 dark:border-gray-600 focus:border-orange-500 focus:ring-orange-500 pr-10",required:!0}),e.jsx("button",{type:"button",className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300",onClick:()=>L(!u),children:u?e.jsx(E,{className:"h-4 w-4"}):e.jsx(S,{className:"h-4 w-4"})})]}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Must be at least 8 characters long"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"confirmPassword",className:"text-gray-700 dark:text-gray-300",children:"Confirm Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(P,{id:"confirmPassword",type:f?"text":"password",placeholder:"Confirm new password",value:y,onChange:o=>O(o.target.value),className:"rounded-xl border-gray-300 dark:border-gray-600 focus:border-orange-500 focus:ring-orange-500 pr-10",required:!0}),e.jsx("button",{type:"button",className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300",onClick:()=>I(!f),children:f?e.jsx(E,{className:"h-4 w-4"}):e.jsx(S,{className:"h-4 w-4"})})]})]}),e.jsx("button",{type:"submit",disabled:b,className:"w-full bg-gradient-to-r from-orange-500 to-red-800 hover:from-orange-600 hover:to-red-900 text-white font-medium py-4 rounded-2xl text-xl transition-all duration-200 flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:b?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Updating Password..."]}):e.jsxs(e.Fragment,{children:["Update Password",e.jsx(j,{className:"h-5 w-5"})]})})]})]})}),e.jsx("div",{className:"mt-6 text-center",children:e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Remember your password?"," ",e.jsx($,{to:"/login",className:"text-orange-600 hover:underline font-medium",children:"Sign in here"})]})})]})})}export{K as default};
