import{k as F,j as e,l as d}from"./index-BAAyN0wm.js";import{r as t,u as q,g as A,L as V}from"./react-vendor-CaQki1kR.js";import{L as y,I as N}from"./label-BPjYTGLq.js";import{C as c,d as m}from"./card-VX4ullBD.js";import{o as Y,A as f,n as M,E as v,l as k}from"./ui-vendor-DU0NExUN.js";function z(){const[n,P]=t.useState(""),[p,C]=t.useState(""),[x,E]=t.useState(!1),[h,R]=t.useState(!1),[w,j]=t.useState(!1),[S,L]=t.useState(!1),[g,i]=t.useState(null),[O,u]=t.useState(""),{toast:r}=F(),b=q(),[T]=A(),o=T.get("token");t.useEffect(()=>{if(!o){i(!1),u("No reset token provided");return}(async()=>{try{const s=await fetch(`https://ondorealestateserver.onrender.com/api/password/verify-reset-token/${o}`),l=await s.json();s.ok&&l.valid?i(!0):(i(!1),u(l.message||"Invalid or expired reset token"))}catch(s){console.error("Token verification error:",s),i(!1),u("Failed to verify reset token")}})()},[o]);const I=async a=>{if(a.preventDefault(),!n){r({title:"Password required",description:"Please enter a new password.",variant:"destructive"});return}if(n.length<8){r({title:"Password too short",description:"Password must be at least 8 characters long.",variant:"destructive"});return}if(n!==p){r({title:"Passwords don't match",description:"Please make sure both passwords are identical.",variant:"destructive"});return}if(!o||g!==!0){r({title:"Invalid token",description:"The reset token is invalid or expired.",variant:"destructive"});return}j(!0);try{const s=await fetch("https://ondorealestateserver.onrender.com/api/password/reset-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:o,password:n})}),l=await s.json();s.ok?(L(!0),r({title:"Password updated",description:"Your password has been successfully reset."})):r({title:"Error",description:l.message||"Failed to reset password.",variant:"destructive"})}catch(s){console.error("Reset password error:",s),r({title:"Error",description:"An unexpected error occurred. Please try again.",variant:"destructive"})}finally{j(!1)}};return g===!1?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-white dark:bg-gray-900 p-4",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsx("div",{className:"flex flex-col items-center mb-8",children:e.jsxs("div",{className:"flex items-center mb-6",children:[e.jsx("img",{src:d(),alt:"Ondo Real Estate logo",className:"h-16 w-auto mr-3"}),e.jsx("span",{className:"text-6xl font-medium bg-gradient-to-r from-orange-500 to-red-800 text-transparent bg-clip-text",children:"Ondo Real Estate"})]})}),e.jsx(c,{className:"border-none shadow-lg",children:e.jsxs(m,{className:"pt-6 text-center",children:[e.jsx("div",{className:"flex justify-center mb-6",children:e.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center",children:e.jsx(Y,{className:"h-8 w-8 text-red-600"})})}),e.jsx("h1",{className:"text-2xl font-medium mb-4 bg-gradient-to-r from-orange-500 to-red-800 text-transparent bg-clip-text",children:"Invalid Reset Link"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:O||"The password reset link is invalid or has expired."}),e.jsxs("button",{onClick:()=>b("/forgot-password"),className:"w-full bg-gradient-to-r from-orange-500 to-red-800 hover:from-orange-600 hover:to-red-900 text-white font-medium py-4 rounded-2xl text-xl transition-all duration-200 flex items-center justify-center gap-2",children:["Request New Reset Link",e.jsx(f,{className:"h-5 w-5"})]})]})})]})}):g===null?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-white dark:bg-gray-900 p-4",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsx("div",{className:"flex flex-col items-center mb-8",children:e.jsxs("div",{className:"flex items-center mb-6",children:[e.jsx("img",{src:d(),alt:"Ondo Real Estate logo",className:"h-16 w-auto mr-3"}),e.jsx("span",{className:"text-6xl font-medium bg-gradient-to-r from-orange-500 to-red-800 text-transparent bg-clip-text",children:"Ondo Real Estate"})]})}),e.jsx(c,{className:"border-none shadow-lg",children:e.jsxs(m,{className:"pt-6 text-center",children:[e.jsx("div",{className:"flex justify-center mb-6",children:e.jsx("div",{className:"w-8 h-8 border-2 border-orange-500 border-t-transparent rounded-full animate-spin"})}),e.jsx("h1",{className:"text-2xl font-medium mb-4 bg-gradient-to-r from-orange-500 to-red-800 text-transparent bg-clip-text",children:"Verifying Reset Link"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Please wait while we verify your reset link..."})]})})]})}):S?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-white dark:bg-gray-900 p-4",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsx("div",{className:"flex flex-col items-center mb-8",children:e.jsxs("div",{className:"flex items-center mb-6",children:[e.jsx("img",{src:d(),alt:"Ondo Real Estate logo",className:"h-16 w-auto mr-3"}),e.jsx("span",{className:"text-6xl font-medium bg-gradient-to-r from-orange-500 to-red-800 text-transparent bg-clip-text",children:"Ondo Real Estate"})]})}),e.jsx(c,{className:"border-none shadow-lg",children:e.jsxs(m,{className:"pt-6 text-center",children:[e.jsx("div",{className:"flex justify-center mb-6",children:e.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center",children:e.jsx(M,{className:"h-8 w-8 text-green-600"})})}),e.jsx("h1",{className:"text-2xl font-medium mb-4 bg-gradient-to-r from-orange-500 to-red-800 text-transparent bg-clip-text",children:"Password Reset Successful"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"Your password has been successfully updated. You can now sign in with your new password."}),e.jsxs("button",{onClick:()=>b("/login"),className:"w-full bg-gradient-to-r from-orange-500 to-red-800 hover:from-orange-600 hover:to-red-900 text-white font-medium py-4 rounded-2xl text-xl transition-all duration-200 flex items-center justify-center gap-2",children:["Continue to Login",e.jsx(f,{className:"h-5 w-5"})]})]})})]})}):e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-white dark:bg-gray-900 p-4",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsxs("div",{className:"flex flex-col items-center mb-8",children:[e.jsxs("div",{className:"flex items-center mb-6",children:[e.jsx("img",{src:d(),alt:"Ondo Real Estate logo",className:"h-16 w-auto mr-3"}),e.jsx("span",{className:"text-6xl font-medium bg-gradient-to-r from-orange-500 to-red-800 text-transparent bg-clip-text",children:"Ondo Real Estate"})]}),e.jsx("h1",{className:"text-2xl font-medium bg-gradient-to-r from-orange-500 to-red-800 text-transparent bg-clip-text",children:"Reset Password"})]}),e.jsx(c,{className:"border-none shadow-lg",children:e.jsxs(m,{className:"pt-6",children:[e.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-center mb-6",children:"Enter your new password below. Make sure it's strong and secure."}),e.jsxs("form",{onSubmit:I,className:"space-y-5",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(y,{htmlFor:"password",className:"text-gray-700 dark:text-gray-300",children:"New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(N,{id:"password",type:x?"text":"password",placeholder:"Enter new password",value:n,onChange:a=>P(a.target.value),className:"rounded-xl border-gray-300 dark:border-gray-600 focus:border-orange-500 focus:ring-orange-500 pr-10",required:!0}),e.jsx("button",{type:"button",className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300",onClick:()=>E(!x),children:x?e.jsx(v,{className:"h-4 w-4"}):e.jsx(k,{className:"h-4 w-4"})})]}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Must be at least 8 characters long"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(y,{htmlFor:"confirmPassword",className:"text-gray-700 dark:text-gray-300",children:"Confirm Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(N,{id:"confirmPassword",type:h?"text":"password",placeholder:"Confirm new password",value:p,onChange:a=>C(a.target.value),className:"rounded-xl border-gray-300 dark:border-gray-600 focus:border-orange-500 focus:ring-orange-500 pr-10",required:!0}),e.jsx("button",{type:"button",className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300",onClick:()=>R(!h),children:h?e.jsx(v,{className:"h-4 w-4"}):e.jsx(k,{className:"h-4 w-4"})})]})]}),e.jsx("button",{type:"submit",disabled:w,className:"w-full bg-gradient-to-r from-orange-500 to-red-800 hover:from-orange-600 hover:to-red-900 text-white font-medium py-4 rounded-2xl text-xl transition-all duration-200 flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:w?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Updating Password..."]}):e.jsxs(e.Fragment,{children:["Update Password",e.jsx(f,{className:"h-5 w-5"})]})})]})]})}),e.jsx("div",{className:"mt-6 text-center",children:e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Remember your password?"," ",e.jsx(V,{to:"/login",className:"text-orange-600 hover:underline font-medium",children:"Sign in here"})]})})]})})}export{z as default};
